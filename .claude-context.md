# Contexto del Proyecto - DAW 2º

## Información del Estudiante
- **Nombre:** Javi (usuario)
- **Situación:** Alterna entre casa y academia
- **Nivel:** Aprendiendo Laravel, prefiere explicaciones simples

## Entorno de Trabajo
- **Casa:** Windows, XAMPP, MySQL con contraseña `1234`
- **Academia:** Configuración diferente (verificar `.env` allí)
- **Base de datos:** `mi_primera_laravel`

## Preferencias de Código
- **Estilo:** Simple y directo, sin complicaciones
- **Explicaciones:** Para "tontos", paso a paso
- **Consistencia:** Mantener el mismo nivel y estilo del código existente
- **Evitar:**
  - Redirecciones complejas
  - Código con muchas capas de abstracción
  - Comandos SQL directos (usar phpMyAdmin/Workbench)
  - `composer update` (siempre usar `composer install`)

## Reglas de Código ESTRICTAS (SIEMPRE cumplir)

### ❌ PROHIBIDO:
1. **Múltiples returns:** Solo UN return por función/método
2. **break y continue:** Nunca usar en bucles
3. **Comparación estricta (===):** Solo usar `==` (dos iguales), nunca `===` (tres iguales)
4. **Variables con nombres cortos:** Nunca `$i`, `$e`, `$n`, etc.

### ✅ OBLIGATORIO:
1. **Un solo return:** Al final de la función
2. **Nombres descriptivos:** `$usuario`, `$contador`, `$nombreCompleto`
3. **Comparaciones:** Usar `==` y `!=` solamente
4. **Flujo lineal:** Sin breaks ni continues, usar variables de control

### Ejemplo CORRECTO:
```php
public function buscarUsuario($id)
{
    $usuario = null;
    $encontrado = Usuario::find($id);

    if ($encontrado) {
        $usuario = $encontrado;
    }

    return $usuario;  // Un solo return
}
```

### Ejemplo INCORRECTO:
```php
public function buscarUsuario($id)
{
    $u = Usuario::find($id);  // ❌ Nombre corto

    if ($u === null) {  // ❌ Tres iguales
        return null;     // ❌ Return temprano
    }

    return $u;  // ❌ Segundo return
}
```

## Problemas Conocidos

### server.php se borra
- **Causa:** `composer update` ejecutado en background
- **Solución:** `git checkout HEAD -- server.php`
- **Prevención:** Nunca usar `composer update`, solo `composer install`

### .env no se sube a Git
- **Correcto:** `.env` está en `.gitignore`
- **Template:** `.env.example` SÍ se sube (sin contraseñas)
- **Diferencia:** Cada entorno tiene su propio `.env` con sus credenciales

## Flujo de Trabajo Casa ↔ Academia

### Al llegar (casa o academia):
```bash
git pull
composer install
# Verificar .env (cada lugar tiene el suyo)
php artisan migrate  # Si hay nuevas migraciones
php artisan serve
```

### Antes de irte:
```bash
git add .
git commit -m "descripción"
git push
```

## Archivos Importantes del Proyecto

### Laravel (UD3/holaMundo)
- `routes/web.php` - Rutas de vistas
- `routes/api.php` - Endpoints API
- `app/Http/Controllers/` - Controladores
- `app/Models/` - Modelos
- `resources/views/` - Vistas Blade
- `database/migrations/` - Migraciones
- `server.php` - **CRÍTICO** para `php artisan serve`

### Documentación
- `UD3/CHULETA-LARAVEL.md` - Comandos y referencia rápida

## Comandos Frecuentes

```bash
# Servidor
php artisan serve

# Base de datos
php artisan migrate
php artisan migrate:fresh --seed

# Configuración
php artisan config:clear
php artisan key:generate

# Git
git status
git add .
git commit -m "mensaje"
git push
git pull

# Composer
composer install  # ✅ SIEMPRE ESTE
composer update   # ❌ NUNCA (causa problemas)
```

## Convenciones del Proyecto

### Pasar datos a vistas
```php
// En controlador o ruta
return view('nombre-vista', ['variableEnVista' => $variableLocal]);

// En la vista
{{ $variableEnVista }}
```

### Formularios
```blade
<form action="/ruta" method="POST">
    @csrf
    <input name="campo" type="text">
    <button type="submit">Enviar</button>
</form>
```

### Rutas
```php
Route::get('/ruta', function () { ... });
Route::post('/ruta', [Controlador::class, 'metodo']);
```

## Recordatorios
- `@csrf` es OBLIGATORIO en formularios POST
- Los imports deben estar al principio (`use App\Models\Usuario;`)
- Laravel usa "magic methods" - ignora warnings del IDE sobre propiedades privadas
- El `.env` de casa tiene contraseña `1234`, en academia puede ser diferente
